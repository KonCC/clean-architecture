# 20장 업무 규칙

- 업무 규칙 : 사업적으로 수익을 얻거나 비용을 줄일 수 있는 규칙 또는 절차
  - EX) 은행의 업무 규칙 : 대출에 N% 이자를 부과한다.

- 핵심 업무 규칙은 보통 데이터를 요구한다. = 핵심 업무 데이터
  - EX) 대출에는 대출 잔액, 이자율, 지급 일정 등의 데이터가 필요하다.

- 핵심 규칙과 핵심 데이터는 본질적으로 결합되어 있기 때문에 객체로 만들 좋은 후보이다. = **엔티티(Entity)**



## 엔티티

- 핵심 업무 데이터를 기반으로 동작하는 핵심 업무 규칙을 구체화(구현 함수)
- 핵심 업무 데이터를 직접 포함하거나 매우 쉽게 접근할 수 있다.
- 데이터베이스, 사용자 인터페이스, 서드파티 프레임워크에 대한 고려사항들로 인해 오염되서는 안 된다.
  - 어떤 시스템에서도 업무를 수행하며, 데이터 저장 방식 또는 컴퓨터가 배치되는 방식과도 무관하다.
- 엔티티는 순전히 업무에 대한 것이다.



## 유스케이스

- 유스케이스는 (엔티티와 다르게) 애플리케이션에 특화된 업무 규칙을 설명한다.
  - 엔티티 내부의 핵심 업무 규칙이 어떻게, 언제 호출할지를 명시하는 규칙을 담는다.
- 인터페이스로 들어오는 데이터와 되돌려주는 데이터를 형식 없이 명시한다는 점만 빼면, 사용자 인터페이스를 기술하지 않음
  - 시스템에서 어떤 방식으로 데이터가 들어오고 나가는 지는 유스케이스와 무관한다.
- 유스케이스는 객체이다. 애플리케이션에 특화된 업무 규칙을 구현하는 함수를 제공한다.
- 입력 데이터, 출력 데이터, 유스케이스가 상호작용하는 엔티티에 대한 참조 데이터 등의 데이터 요소를 포함한다.
- 엔티티(고수준)는 자신을 제어하는 유스케이스(저수준)에 대해 아무것도 알지 못한다. (의존성 역전 원칙)
  - 유스케이스는 엔티티에 의존한다.



### 요청 및 응답 모델

- 유스케이스는 단순한 요청 데이터 구조를 입력으로 받아들이고, 단순한 응답 데이터 구조를 출력으로 반환한다.
- `HttpRequest` 나 `HttpResponse`와 같은 표준 프레임워크 인터페이스로부터 파생되지 않는다.
- 요청 및 응답 모델을 독립적으로 만들어야 한다. (의존성 제거)



## 결론

업무 규칙은 소프트웨어 시스템이 존재하는 이유이고 핵심적인 기능이다.
업무 규칙은 사용자 인터페이스나 데이터베이스와 같은 저수준의 관심사로 인해 오염되서는 안된다.